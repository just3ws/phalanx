{
  "$ref": "#/definitions/TransactionDetail",
  "definitions": {
    "TransactionDetail": {
      "anyOf": [
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "deploy"
            },
            "gridIndex": {
              "type": "integer",
              "minimum": 0,
              "maximum": 7
            },
            "phaseAfter": {
              "type": "string",
              "enum": [
                "setup",
                "deployment",
                "combat",
                "reinforcement",
                "gameOver"
              ]
            }
          },
          "required": [
            "type",
            "gridIndex",
            "phaseAfter"
          ],
          "additionalProperties": false
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "attack"
            },
            "combat": {
              "type": "object",
              "properties": {
                "turnNumber": {
                  "type": "integer",
                  "minimum": 0
                },
                "attackerPlayerIndex": {
                  "type": "integer",
                  "minimum": 0,
                  "maximum": 1
                },
                "attackerCard": {
                  "type": "object",
                  "properties": {
                    "suit": {
                      "type": "string",
                      "enum": [
                        "spades",
                        "hearts",
                        "diamonds",
                        "clubs"
                      ]
                    },
                    "rank": {
                      "type": "string",
                      "enum": [
                        "A",
                        "2",
                        "3",
                        "4",
                        "5",
                        "6",
                        "7",
                        "8",
                        "9",
                        "T",
                        "J",
                        "Q",
                        "K"
                      ]
                    }
                  },
                  "required": [
                    "suit",
                    "rank"
                  ],
                  "additionalProperties": false
                },
                "targetColumn": {
                  "type": "integer",
                  "minimum": 0,
                  "maximum": 3
                },
                "baseDamage": {
                  "type": "integer"
                },
                "steps": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "target": {
                        "type": "string",
                        "enum": [
                          "frontCard",
                          "backCard",
                          "playerLp"
                        ]
                      },
                      "card": {
                        "type": "object",
                        "properties": {
                          "suit": {
                            "type": "string",
                            "enum": [
                              "spades",
                              "hearts",
                              "diamonds",
                              "clubs"
                            ]
                          },
                          "rank": {
                            "type": "string",
                            "enum": [
                              "A",
                              "2",
                              "3",
                              "4",
                              "5",
                              "6",
                              "7",
                              "8",
                              "9",
                              "T",
                              "J",
                              "Q",
                              "K"
                            ]
                          }
                        },
                        "required": [
                          "suit",
                          "rank"
                        ],
                        "additionalProperties": false
                      },
                      "incomingDamage": {
                        "type": "integer"
                      },
                      "hpBefore": {
                        "type": "integer"
                      },
                      "effectiveHp": {
                        "type": "integer"
                      },
                      "absorbed": {
                        "type": "integer"
                      },
                      "overflow": {
                        "type": "integer"
                      },
                      "damage": {
                        "type": "integer"
                      },
                      "hpAfter": {
                        "type": "integer"
                      },
                      "destroyed": {
                        "type": "boolean"
                      },
                      "lpBefore": {
                        "type": "integer"
                      },
                      "lpAfter": {
                        "type": "integer"
                      },
                      "bonuses": {
                        "type": "array",
                        "items": {
                          "type": "string",
                          "enum": [
                            "aceInvulnerable",
                            "aceVsAce",
                            "diamondDeathShield",
                            "clubDoubleOverflow",
                            "spadeDoubleLp",
                            "heartHalveLp"
                          ]
                        }
                      }
                    },
                    "required": [
                      "target",
                      "incomingDamage",
                      "damage"
                    ],
                    "additionalProperties": false
                  }
                },
                "totalLpDamage": {
                  "type": "integer"
                }
              },
              "required": [
                "turnNumber",
                "attackerPlayerIndex",
                "attackerCard",
                "targetColumn",
                "baseDamage",
                "steps",
                "totalLpDamage"
              ],
              "additionalProperties": false
            },
            "reinforcementTriggered": {
              "type": "boolean"
            },
            "victoryTriggered": {
              "type": "boolean"
            }
          },
          "required": [
            "type",
            "combat",
            "reinforcementTriggered",
            "victoryTriggered"
          ],
          "additionalProperties": false
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "pass"
            }
          },
          "required": [
            "type"
          ],
          "additionalProperties": false
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "reinforce"
            },
            "column": {
              "type": "integer",
              "minimum": 0,
              "maximum": 3
            },
            "gridIndex": {
              "type": "integer",
              "minimum": 0,
              "maximum": 7
            },
            "cardsDrawn": {
              "type": "integer",
              "minimum": 0
            },
            "reinforcementComplete": {
              "type": "boolean"
            }
          },
          "required": [
            "type",
            "column",
            "gridIndex",
            "cardsDrawn",
            "reinforcementComplete"
          ],
          "additionalProperties": false
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "forfeit"
            },
            "winnerIndex": {
              "type": "integer",
              "minimum": 0,
              "maximum": 1
            }
          },
          "required": [
            "type",
            "winnerIndex"
          ],
          "additionalProperties": false
        }
      ]
    }
  },
  "$schema": "http://json-schema.org/draft-07/schema#"
}
